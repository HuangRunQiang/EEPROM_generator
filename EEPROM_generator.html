<head>
   <title>üîÅ ESI / EEPROM Generator for SOES</title>
   <meta charset="UTF-8">
   <script src="EEPROM_generator.js"></script>
   <link rel="stylesheet" href="EEPROM_generator.css">
   <!--<script src="saveRestore.js"></script>-->
</head>

<body>
   <!-- Modal dialog to edit OD objects  -->
   <div id="editObjectModal" class="modal">
   <!-- Modal content -->
      <div class="modal-content">
         <span class="close" onClick="modalClose()">&times;</span>
         <p><div id="editObjectTitle">Edit object</div></p>
         <form name="EditObjectForm" id="EditObjectForm" action="" onsubmit="onEditObjectSubmit(this); return false;">
            <table border="0">
               <tr id="dialogRowIndex">
                  <td>Index:</td>
                  <td><input type = "text" name="Index" value="0x6000" title="Enter OD index for the new object"></td>
               </tr>
               <tr>
                  <td>Name of Object:</td>
                  <td><input type = "text" name="ObjectName" value="" title="Enter name for the new object"></td>
               </tr>
               <tr id="dialogRowDtype">
                  <td>Data Type</td>
                  <td><select type = "text" name="DTYPE" title="Enter data type of new object">
                     <option value="BOOLEAN">BOOLEAN</option>
                     <option value="INTEGER8">INTEGER8</option>
                     <option value="INTEGER16">INTEGER16</option>
                     <option value="INTEGER32">INTEGER32</option>
                     <option value="UNSIGNED8">UNSIGNED8</option>
                     <option value="UNSIGNED16">UNSIGNED16</option>
                     <option value="UNSIGNED32">UNSIGNED32</option>
                     <option value="REAL32">REAL32</option>
                     <option value="VISIBLE_STRING">VISIBLE STRING</option>
                  </select></td>
               </tr>
               <tr id="dialogRowValue">
                  <td>Value:</td>
                  <td><input type = "text" name="InitalValue" value="0" title="Enter initial value for the new object"></td>
               </tr>
               <tr id="dialogRowAccess">
                  <td>Access:</td>
                  <td><select type = "text" name="Access" title="Enter access mode of new object">
                     <option value="RO">RO</option>
                     <option value="RW">RW</option>
                     <option value="WO">WO</option>
                  </select></td>
               </tr>
               <tr>
                  <td colspan="6" align="center">
                     <input type="button" name="Cancel" value="&nbsp;Cancel&nbsp;" onClick='modalClose();'>
                     <input type="submit" name="SaveChanges" value="&nbsp;Save changes&nbsp;">
                  </td>
               </tr>
            </table>
         </form>
      </div>
   </div>

<h2>EtherCAT EEPROM & SOES OD code generator</h2>
This page serves as a tool to generate consistent data across your code, ESI file and EEPROM data. Hover over the fields to get additional info about the items you can change. <br><br>
<p>For more detail on how these values translate to the corresponding files, and where you can find more info in the ETG documentation, look into the <a href="EEPROM_generator.js">source of the javascript that generates these files</a>.</p>

<form  name="SlaveForm" id="SlaveForm" action="" onsubmit="return false;">
<table border="0">
   <tr>
      <td><strong>Item:</strong></td><td><strong>Value</strong></td><td width="12%"><strong>ESI</strong></td><td width="12%"><strong>EEPROM</strong></td><td width="12%"><strong>objectlist.c</strong></td><td width="12%"><strong>ecat_options.h</strong></td>
   </tr>
   <tr>
      <td>Name of Vendor:</td><td><input type = "text" name="VendorName" value="ACME EtherCAT Devices" title="Enter the name as how you are known in the EtherCAT Technology Group members list"></td><td>x</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
   </tr>
   <tr>
      <td>VendorID:</td><td><input type = "text" name="VendorID" value="0x000" title="You need to be member of the ETG to get a VendorID!&#013; Enter in hex (0x...) or decimal."></td><td>x</td><td>x</td><td>x</td><td>&nbsp;</td>
   </tr>
   <tr>
      <td>ProductCode:</td><td><input type = "text" name="ProductCode" value="0x00ab123" title="The code of your Product...&#013;Each different product should have its own code.&#013;Enter in hex (0x...) or decimal."></td><td>x</td><td>x</td><td>x</td><td>&nbsp;</td>
   </tr>
   <tr>
      <td>RevisionNumber:</td><td><input type = "text" name="RevisionNumber" value="0x002" title="Revision of Product&#013; Enter in hex (0x...) or decimal."></td><td>x</td><td>x</td><td>x</td><td>&nbsp;</td>
   </tr>
   <tr>
      <td>SerialNumber:</td><td><input type = "text" name="SerialNumber" value="0x001" title="Serial number; may be used in production.&#013; Enter in hex (0x...) or decimal."></td><td>x</td><td>x</td><td>x</td><td>&nbsp;</td>
   </tr>
   <tr>
      <td>Hardware version:</td><td><input type = "text" name="HWversion" value="0.0.1" title="Enter HW version as string"><td>x</td><td>x</td><td>x</td><td>&nbsp;</td>
   </tr>
   <tr>
      <td>Software version:</td><td><input type = "text" name="SWversion" value="0.0.1" title="Enter SW version as string"></td><td>x</td><td>x</td><td>x</td><td>&nbsp;</td>
   </tr>
   <tr><td colspan="6"><hr></td</tr>
   <tr>
      <td>Number of <strong>bytes</strong> in EEPROM:</td><td><input type = "text" name="EEPROMsize" value="2048" title="Number of bytes in EEPROM; 2048&#013;2048*8=16kilobit&#013;Enter in hex (0x...) or decimal."></td><td>x</td><td>x</td><td>&nbsp;</td><td>&nbsp;</td>
   </tr>
   <!-- <tr>
      <td>Number of <strong>bytes</strong> in EEPROM:</td><td><select name="HEX_Format" title="Binary Format">
         <option value="ihex">Intel HEX</option>
         <option value="bin">Raw .bin</option>
      </select></td><td></td><td>x</td><td>&nbsp;</td><td>&nbsp;</td>   
   </tr> -->
   <tr>
      <td>RxMailbox Offset:</td><td><input type = "text" name="RxMailboxOffset" value="0x1000" title="Offset in memory. Do not change unless you are really sure what you're doing"></td><td>x</td><td>x</td><td>&nbsp;</td><td>x</td>
   </tr>
   <tr>
      <td>TxMailbox Offset:</td><td><input type = "text" name="TxMailboxOffset" value="0x1200" title="Offset in memory. Do not change unless you are really sure what you're doing"></td><td>x</td><td>x</td><td>&nbsp;</td><td>x</td>
   </tr>
   <tr>
      <td>Tx AND Rx Mailbox Size:</td><td><input type = "text" name="MailboxSize" value="512" title="Size of mailbox in bytes.&#013;Do not change unless you are really sure what you're doing."></td><td>x</td><td>x</td><td>&nbsp;</td><td>x</td>
   </tr>
   <tr>
      <td>SyncManager 2 offset:</td><td><input type = "text" name="SM2Offset" value="0x1400" title="Offset in memory. Do not change unless you are really sure what you're doing"></td><td>x</td><td>x</td><td>&nbsp;</td><td>x</td>
   </tr>
   <tr>
      <td>SyncManager 3 offset:</td><td><input type = "text" name="SM3Offset" value="0x1A00" title="Offset in memory. Do not change unless you are really sure what you're doing"></td><td>x</td><td>x</td><td>&nbsp;</td><td>x</td>
   </tr>
   <tr><td colspan="6"><hr></td</tr>
   <tr>
      <td>Group Type:</td><td><input type = "text" name="TextGroupType" value="DigIn" title="Group Type, like DigIn, DigOut, Measurement, ...&#013;See ETG2000, this is used for grouping in the ESI file"></td><td>x</td><td>x</td><td>&nbsp;</td><td>&nbsp;</td>
   </tr>
   <tr>
      <td>Group Name:</td><td><input type = "text" name="TextGroupName5" value="Digital input" title="Description of Group&#013;See ETG2000, this is used for grouping in the ESI file"></td><td>x</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
   </tr>
   <tr>
      <td>Image Name:</td><td><input type = "text" name="ImageName" value="IMGCBY" title="Name of image used in EtherCAT Configurator"></td><td>&nbsp;</td><td>x</td><td>&nbsp;</td><td>&nbsp;</td>
   </tr>
   <tr>
      <td>Device Type:</td><td><input type = "text" name="TextDeviceType" value="DigIn2000" title="Name or order code of product"></td><td>x</td><td>x</td><td>&nbsp;</td><td>&nbsp;</td>
   </tr>
   <tr>
      <td>Device Name:</td><td><input type = "text" name="TextDeviceName" value="2-channel Hypergalactic input superimpermanator" title="Description of your device"></td><td>x</td><td>x</td><td>x</td><td>&nbsp;</td>
   </tr>
   <tr><td colspan="6"><hr></td</tr>
   <tr>
      <td>Port 0 Physical interface:</td><td><select name="Port0Physical" title="Select which physical connection is used on each physical port of your Beckhoff ASIC (ET1100, ET1200)">
         <option value="Y" selected>MII</option>
         <option value="H">MII-Fast Hot Connect</option>
         <option value="K">EBUS</option>
         <option value=" ">Not Used</option>
      </select></td><td>x</td><td>x</td><td>&nbsp;</td><td>&nbsp;</td>
   </tr>
   <tr>
      <td>Port 1 Physical interface:</td><td><select name="Port1Physical" title="Select which physical connection is used on each physical port of your Beckhoff ASIC (ET1100, ET1200)">
         <option value="Y" selected>MII</option>
         <option value="H">MII-Fast Hot Connect</option>
         <option value="K">EBUS</option>
         <option value=" ">Not Used</option>
      </select></td><td>x</td><td>x</td><td>&nbsp;</td><td>&nbsp;</td>
   </tr>
   <tr>
      <td>Port 2 Physical interface:</td><td><select name="Port2Physical" title="Select which physical connection is used on each physical port of your Beckhoff ASIC (ET1100, ET1200)">
         <option value="Y">MII</option>
         <option value="H">MII-Fast Hot Connect</option>
         <option value="K">EBUS</option>
         <option value=" " selected>Not Used</option>
      </select></td><td>x</td><td>x</td><td>&nbsp;</td><td>&nbsp;</td>
   </tr>
   <tr>
      <td>Port 3 Physical interface:</td><td><select name="Port3Physical" title="Select which physical connection is used on each physical port of your Beckhoff ASIC (ET1100, ET1200)">
         <option value="Y">MII</option>
         <option value="H">MII-Fast Hot Connect</option>
         <option value="K">EBUS</option>
         <option value=" " selected>Not Used</option>
      </select></td><td>x</td><td>x</td><td>&nbsp;</td><td>&nbsp;</td>
   </tr>
   <tr><td colspan="6"><hr></td</tr>
   <tr>
      <td>ESC (EtherCAT Slave Chip):</td><td><select name="ESC" title="Select which ESC (EtherCAT Slave Chip) is used">
         <option value="ET1100">ET1100</option>
         <option value="AX58100">AX58100</option>
         <option value="LAN9252">LAN9252</option>
      </select></td><td>x</td><td>x</td><td>&nbsp;</td><td>&nbsp;</td>
   </tr>
   <tr>      
      <td>SPI mode:</td><td><select name="SPImode" title="Select which SPI mode is used">
         <option value="3">3</option>
         <option value="2">2</option>
         <option value="1">1</option>
         <option value="0">0</option>
      </select></td><td>x</td><td>x</td><td>&nbsp;</td><td>&nbsp;</td>
   </tr>   
   <tr><td colspan="6"><hr></td</tr>
   <tr><td><input type="checkbox" name="CoeDetails" value="EnableSDO" checked>Enable SDO<br>
      <input type="checkbox" name="CoeDetails" value="EnableSDOInfo" checked>Enable SDO Info<br>
      <input type="checkbox" name="CoeDetails" value="EnablePDOAssign">Enable PDO Assign<br>
      <input type="checkbox" name="CoeDetails" value="EnablePDOConfiguration">Enable PDO Configuration<br>
      <input type="checkbox" name="CoeDetails" value="EnableUploadAtStartup" checked>Enable Upload at startup<br>
      <input type="checkbox" name="CoeDetails" value="EnableSDOCompleteAccess">Enable SDO complete access <br>
      </td><td>&nbsp;</td><td>x</td><td>x</td><td>&nbsp;</td><td>&nbsp;</td>
   </tr>
   <tr><td colspan="6"><hr></td</tr>
   <tr><td colspan="6">
      <h3>
         <span class="odSectionTitle"> SDO </span>
         <button onClick="editVAR_Click(sdo)">‚ûï Add variable</button>
         <button onClick="editARRAY_Click(sdo)">‚ûï Add Array</button>
         <button onClick="editRECORD_Click(sdo)">‚ûï Add Record</button>
      </h3>
      <div id="tr_sdo"></div>
   </td></tr>
   
   <tr><td colspan="6"><hr></td</tr>
   <tr><td colspan="6">
      <h3>
         <span class="odSectionTitle"> TXPDO  (slv to master) </span>
         <button onClick="editVAR_Click(txpdo)">‚ûï Add variable</button>
         <button onClick="editARRAY_Click(txpdo)">‚ûï Add Array</button>
         <button onClick="editRECORD_Click(txpdo)">‚ûï Add Record</button>
      </h3>
      <div id="tr_txpdo"></div>
   </td></tr>
   
   <tr><td colspan="6"><hr></td</tr>
   <tr><td colspan="6">
      <h3>
         <span class="odSectionTitle"> RXPDO  (master to slv) </span>
         <button onClick="editVAR_Click(rxpdo)">‚ûï Add variable</button>
         <button onClick="editARRAY_Click(rxpdo)">‚ûï Add Array</button>
         <button onClick="editRECORD_Click(rxpdo)">‚ûï Add Record</button>
      </h3>
      <div id="tr_rxpdo"></div>
   </td></tr>

   <tr><td colspan="6"><hr></td</tr>
   <tr><td colspan="6" align="center">
      <input type="button" name="GenerateDownload" value="‚è¨ &nbsp; Download all files &nbsp;" onclick="onGenerateDownloadClick()">
      <input type="button" id='GenerateFilesButton' name="Generate" value="&nbsp; Generate files &nbsp;" onClick="onGenerateClick();">
      <input type="button" name="Save" value="‚§µÔ∏è &nbsp; Save project &nbsp;" onClick='onSaveClick();'>
      <input type="button" name="Restore" value="‚§¥Ô∏è &nbsp; Restore project &nbsp;" onClick='onRestoreClick();'> 
      <input type="button" name="Reset" value="‚ÄºÔ∏è &nbsp; Reset project &nbsp;" onClick='onResetClick();'> 
   </td></tr>
</table>
<br><br>
</form>
   <form name="outCodeForm" id="outCodeForm" action="" onsubmit="return false;">
   ESI file:<input type="button" name="DownloadESI" value="üîΩ &nbsp; Download &nbsp;" onClick="downloadFile(getOutputForm().ESI.value, fileName = 'esi.xml', contentType = 'text/html');"><br>
   <textarea cols = "150" rows = "12" name="ESI">ESI File</textarea><br><br>
   EEPROM HEX file:
   <input type="button" name="Download_HEX" value="üîΩ &nbsp; Download &nbsp;" onClick="downloadFile(getOutputForm().HEX.value, fileName = 'eeprom.hex', contentType = 'application/octet-stream');">
   <input type="button" name="Download_BIN" value="üîΩ &nbsp; Download .bin &nbsp;" onClick="onDownloadBinClick();">
   <br>
   <!-- TODO this probably is wrong MIME type, check another one: https://www.sitepoint.com/mime-types-complete-list/ -->
   To flash generated binary, install SOEM and run 
   <br><br><i id="hexInstallCmd">sudo ./eepromtool 1 eth0 -wi eeprom.hex</i><br><br>
   <textarea cols = "150" rows = "12" name="HEX">Hex File</textarea><br><br>
   ecat_options.h: <input type="button" name="Download_ecat_options" value="üîΩ &nbsp; Download &nbsp;" onClick="downloadFile(getOutputForm().ecat_options.value, fileName = 'ecat_options.h', contentType = 'text/plain');"><br>
   <textarea cols = "150" rows = "12" name="ecat_options">ecat_options.h</textarea><br><br>
   objectlist.c: <input type="button" name="Download_objectlist" value="üîΩ &nbsp; Download &nbsp;" onClick="downloadFile(getOutputForm().objectlist.value, fileName = 'objectlist.c', contentType = 'text/plain');"><br>
   <textarea cols = "150" rows = "12" name="objectlist">objectlist.c</textarea><br><br>
   utypes.h: <input type="button" name="Download_utypes" value="üîΩ &nbsp; Download &nbsp;" onClick="downloadFile(getOutputForm().utypes.value, fileName = 'utypes.h', contentType = 'text/plain');"><br>
   <textarea cols = "150" rows = "12" name="utypes">utypes.h</textarea><br><br>
   <input id="restoreFileInput" type='file' style="visibility:hidden;" onchange="readFile(event)" />
</form>
</body>